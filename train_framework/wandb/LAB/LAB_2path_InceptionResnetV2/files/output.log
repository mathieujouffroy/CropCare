
model --> <keras.engine.functional.Functional object at 0x7f44a87b8430>
[34m[1mwandb[39m[22m: [33mWARNING[39m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
08/04/2022 15:14:55 - INFO - __main__ -
08/04/2022 15:14:55 - INFO - __main__ -     =========== TRAINING MODEL LAB_2path_InceptionResNetV2 ===========
08/04/2022 15:14:55 - INFO - __main__ -     Loss = <keras.losses.CategoricalCrossentropy object at 0x7f45a0498b50>
08/04/2022 15:14:55 - INFO - __main__ -     Optimizer = <keras.optimizers.optimizer_v2.adam.Adam object at 0x7f45c7436eb0>
08/04/2022 15:14:55 - INFO - __main__ -     learning rate = 0.001
08/04/2022 15:14:55 - INFO - __main__ -
Epoch 1/20
2022-08-04 15:15:11.737881: I tensorflow/stream_executor/cuda/cuda_dnn.cc:384] Loaded cuDNN version 8400
  13/1320 [..............................] - ETA: 1:58 - loss: 3.7423 - accuracy: 0.2115 - top-5-accuracy: 0.5192 - f1_m: 0.1455 - precision: 0.3448 - recall: 0.0962 - auc: 0.7524 - prc: 0.1370
WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0697s vs `on_train_batch_end` time: 0.0777s). Check your callbacks.

























































1320/1320 [==============================] - 184s 128ms/step - loss: 0.8640 - accuracy: 0.7477 - top-5-accuracy: 0.9485 - f1_m: 0.7371 - precision: 0.8402 - recall: 0.6833 - auc: 0.9830 - prc: 0.8339 - val_loss: 0.7516 - val_accuracy: 0.7882 - val_top-5-accuracy: 0.9773 - val_f1_m: 0.7909 - val_precision: 0.8184 - val_recall: 0.7658 - val_auc: 0.9791 - val_prc: 0.8582 - lr: 0.0010 - _timestamp: 1659626280.0000 - _runtime: 187.0000
Epoch 2/20


























































1320/1320 [==============================] - 207s 155ms/step - loss: 0.2845 - accuracy: 0.9072 - top-5-accuracy: 0.9959 - f1_m: 0.9088 - precision: 0.9242 - recall: 0.8944 - auc: 0.9964 - prc: 0.9666 - val_loss: 0.3429 - val_accuracy: 0.8895 - val_top-5-accuracy: 0.9942 - val_f1_m: 0.8906 - val_precision: 0.9045 - val_recall: 0.8776 - val_auc: 0.9942 - val_prc: 0.9543 - lr: 0.0010 - _timestamp: 1659626486.0000 - _runtime: 393.0000
Epoch 3/20


























































1320/1320 [==============================] - 168s 126ms/step - loss: 0.1960 - accuracy: 0.9371 - top-5-accuracy: 0.9981 - f1_m: 0.9378 - precision: 0.9464 - recall: 0.9295 - auc: 0.9977 - prc: 0.9811 - val_loss: 1.3115 - val_accuracy: 0.6734 - val_top-5-accuracy: 0.9526 - val_f1_m: 0.6775 - val_precision: 0.7087 - val_recall: 0.6498 - val_auc: 0.9528 - val_prc: 0.7200 - lr: 0.0010 - _timestamp: 1659626712.0000 - _runtime: 619.0000
Epoch 4/20


























































1320/1320 [==============================] - 167s 125ms/step - loss: 0.1506 - accuracy: 0.9510 - top-5-accuracy: 0.9990 - f1_m: 0.9515 - precision: 0.9571 - recall: 0.9461 - auc: 0.9982 - prc: 0.9875 - val_loss: 0.5151 - val_accuracy: 0.8564 - val_top-5-accuracy: 0.9883 - val_f1_m: 0.8581 - val_precision: 0.8702 - val_recall: 0.8467 - val_auc: 0.9858 - val_prc: 0.9195 - lr: 0.0010 - _timestamp: 1659626879.0000 - _runtime: 786.0000
Epoch 5/20


























































1320/1320 [==============================] - 208s 156ms/step - loss: 0.1226 - accuracy: 0.9599 - top-5-accuracy: 0.9991 - f1_m: 0.9602 - precision: 0.9639 - recall: 0.9568 - auc: 0.9984 - prc: 0.9900 - val_loss: 0.1223 - val_accuracy: 0.9591 - val_top-5-accuracy: 0.9996 - val_f1_m: 0.9591 - val_precision: 0.9626 - val_recall: 0.9558 - val_auc: 0.9984 - val_prc: 0.9899 - lr: 0.0010 - _timestamp: 1659627085.0000 - _runtime: 992.0000
Epoch 6/20



























































1320/1320 [==============================] - 169s 126ms/step - loss: 0.1067 - accuracy: 0.9638 - top-5-accuracy: 0.9995 - f1_m: 0.9640 - precision: 0.9666 - recall: 0.9615 - auc: 0.9985 - prc: 0.9913 - val_loss: 0.3370 - val_accuracy: 0.9040 - val_top-5-accuracy: 0.9943 - val_f1_m: 0.9051 - val_precision: 0.9127 - val_recall: 0.8978 - val_auc: 0.9916 - val_prc: 0.9575 - lr: 0.0010 - _timestamp: 1659627256.0000 - _runtime: 1163.0000
Epoch 7/20




























































1320/1320 [==============================] - 168s 125ms/step - loss: 0.0905 - accuracy: 0.9707 - top-5-accuracy: 0.9996 - f1_m: 0.9709 - precision: 0.9730 - recall: 0.9688 - auc: 0.9987 - prc: 0.9932 - val_loss: 0.3215 - val_accuracy: 0.9098 - val_top-5-accuracy: 0.9976 - val_f1_m: 0.9103 - val_precision: 0.9160 - val_recall: 0.9049 - val_auc: 0.9915 - val_prc: 0.9565 - lr: 0.0010 - _timestamp: 1659627457.0000 - _runtime: 1364.0000
Epoch 8/20


























































1320/1320 [==============================] - ETA: 0s - loss: 0.0768 - accuracy: 0.9745 - top-5-accuracy: 1.0000 - f1_m: 0.9744 - precision: 0.9760 - recall: 0.9729 - auc: 0.9990 - prc: 0.9950
Epoch 8: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
1320/1320 [==============================] - 168s 125ms/step - loss: 0.0768 - accuracy: 0.9745 - top-5-accuracy: 1.0000 - f1_m: 0.9744 - precision: 0.9760 - recall: 0.9729 - auc: 0.9990 - prc: 0.9950 - val_loss: 1.4309 - val_accuracy: 0.7809 - val_top-5-accuracy: 0.9651 - val_f1_m: 0.7825 - val_precision: 0.7913 - val_recall: 0.7742 - val_auc: 0.9486 - val_prc: 0.7986 - lr: 0.0010 - _timestamp: 1659627659.0000 - _runtime: 1566.0000
Epoch 9/20


























































1320/1320 [==============================] - 168s 126ms/step - loss: 0.0239 - accuracy: 0.9919 - top-5-accuracy: 1.0000 - f1_m: 0.9920 - precision: 0.9925 - recall: 0.9915 - auc: 0.9998 - prc: 0.9992 - val_loss: 0.0159 - val_accuracy: 0.9946 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9946 - val_precision: 0.9949 - val_recall: 0.9943 - val_auc: 0.9999 - val_prc: 0.9998 - lr: 5.0000e-04 - _timestamp: 1659627825.0000 - _runtime: 1732.0000
Epoch 10/20

























































1320/1320 [==============================] - 168s 126ms/step - loss: 0.0150 - accuracy: 0.9949 - top-5-accuracy: 1.0000 - f1_m: 0.9949 - precision: 0.9952 - recall: 0.9946 - auc: 0.9999 - prc: 0.9997 - val_loss: 0.0527 - val_accuracy: 0.9844 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9843 - val_precision: 0.9848 - val_recall: 0.9839 - val_auc: 0.9988 - val_prc: 0.9949 - lr: 5.0000e-04 - _timestamp: 1659627995.0000 - _runtime: 1902.0000
Epoch 11/20


























































1320/1320 [==============================] - 167s 125ms/step - loss: 0.0243 - accuracy: 0.9913 - top-5-accuracy: 1.0000 - f1_m: 0.9913 - precision: 0.9917 - recall: 0.9909 - auc: 0.9997 - prc: 0.9989 - val_loss: 0.2893 - val_accuracy: 0.9197 - val_top-5-accuracy: 0.9970 - val_f1_m: 0.9211 - val_precision: 0.9256 - val_recall: 0.9169 - val_auc: 0.9919 - val_prc: 0.9642 - lr: 5.0000e-04 - _timestamp: 1659628162.0000 - _runtime: 2069.0000
Epoch 12/20

























































1320/1320 [==============================] - ETA: 0s - loss: 0.0169 - accuracy: 0.9944 - top-5-accuracy: 1.0000 - f1_m: 0.9944 - precision: 0.9946 - recall: 0.9941 - auc: 0.9998 - prc: 0.9992
Epoch 12: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.
1320/1320 [==============================] - 166s 124ms/step - loss: 0.0169 - accuracy: 0.9944 - top-5-accuracy: 1.0000 - f1_m: 0.9944 - precision: 0.9946 - recall: 0.9941 - auc: 0.9998 - prc: 0.9992 - val_loss: 0.2968 - val_accuracy: 0.9326 - val_top-5-accuracy: 0.9988 - val_f1_m: 0.9328 - val_precision: 0.9351 - val_recall: 0.9306 - val_auc: 0.9902 - val_prc: 0.9574 - lr: 5.0000e-04 - _timestamp: 1659628328.0000 - _runtime: 2235.0000
Epoch 13/20



























































1320/1320 [==============================] - 169s 127ms/step - loss: 0.0065 - accuracy: 0.9978 - top-5-accuracy: 1.0000 - f1_m: 0.9979 - precision: 0.9980 - recall: 0.9978 - auc: 1.0000 - prc: 0.9998 - val_loss: 0.0018 - val_accuracy: 0.9996 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9996 - val_precision: 0.9996 - val_recall: 0.9996 - val_auc: 1.0000 - val_prc: 1.0000 - lr: 2.5000e-04 - _timestamp: 1659628496.0000 - _runtime: 2403.0000
Epoch 14/20


























































1320/1320 [==============================] - 168s 125ms/step - loss: 0.0050 - accuracy: 0.9984 - top-5-accuracy: 1.0000 - f1_m: 0.9984 - precision: 0.9984 - recall: 0.9983 - auc: 1.0000 - prc: 0.9999 - val_loss: 0.0022 - val_accuracy: 0.9995 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9995 - val_precision: 0.9995 - val_recall: 0.9995 - val_auc: 1.0000 - val_prc: 0.9999 - lr: 2.5000e-04 - _timestamp: 1659628665.0000 - _runtime: 2572.0000
Epoch 15/20

























































1320/1320 [==============================] - 166s 124ms/step - loss: 0.0042 - accuracy: 0.9985 - top-5-accuracy: 1.0000 - f1_m: 0.9985 - precision: 0.9987 - recall: 0.9984 - auc: 1.0000 - prc: 0.9999 - val_loss: 0.0192 - val_accuracy: 0.9934 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9934 - val_precision: 0.9936 - val_recall: 0.9932 - val_auc: 0.9999 - val_prc: 0.9994 - lr: 2.5000e-04 - _timestamp: 1659628831.0000 - _runtime: 2738.0000
Epoch 16/20


























































1320/1320 [==============================] - ETA: 0s - loss: 0.0045 - accuracy: 0.9984 - top-5-accuracy: 1.0000 - f1_m: 0.9984 - precision: 0.9985 - recall: 0.9984 - auc: 1.0000 - prc: 0.9999
Epoch 16: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.
1320/1320 [==============================] - 169s 126ms/step - loss: 0.0045 - accuracy: 0.9984 - top-5-accuracy: 1.0000 - f1_m: 0.9984 - precision: 0.9985 - recall: 0.9984 - auc: 1.0000 - prc: 0.9999 - val_loss: 0.0220 - val_accuracy: 0.9931 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9930 - val_precision: 0.9935 - val_recall: 0.9925 - val_auc: 0.9997 - val_prc: 0.9989 - lr: 2.5000e-04 - _timestamp: 1659629000.0000 - _runtime: 2907.0000
Epoch 17/20


























































1320/1320 [==============================] - 169s 126ms/step - loss: 0.0023 - accuracy: 0.9991 - top-5-accuracy: 1.0000 - f1_m: 0.9991 - precision: 0.9992 - recall: 0.9991 - auc: 1.0000 - prc: 1.0000 - val_loss: 1.4256e-04 - val_accuracy: 1.0000 - val_top-5-accuracy: 1.0000 - val_f1_m: 1.0000 - val_precision: 1.0000 - val_recall: 1.0000 - val_auc: 1.0000 - val_prc: 1.0000 - lr: 1.2500e-04 - _timestamp: 1659629167.0000 - _runtime: 3074.0000
Epoch 18/20


























































1320/1320 [==============================] - 169s 126ms/step - loss: 0.0012 - accuracy: 0.9996 - top-5-accuracy: 1.0000 - f1_m: 0.9996 - precision: 0.9997 - recall: 0.9996 - auc: 1.0000 - prc: 1.0000 - val_loss: 0.0064 - val_accuracy: 0.9975 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9975 - val_precision: 0.9976 - val_recall: 0.9975 - val_auc: 1.0000 - val_prc: 0.9999 - lr: 1.2500e-04 - _timestamp: 1659629338.0000 - _runtime: 3245.0000
Epoch 19/20


























































1320/1320 [==============================] - 167s 125ms/step - loss: 0.0016 - accuracy: 0.9996 - top-5-accuracy: 1.0000 - f1_m: 0.9995 - precision: 0.9996 - recall: 0.9995 - auc: 1.0000 - prc: 1.0000 - val_loss: 5.8350e-04 - val_accuracy: 0.9999 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9999 - val_precision: 0.9999 - val_recall: 0.9999 - val_auc: 1.0000 - val_prc: 1.0000 - lr: 1.2500e-04 - _timestamp: 1659629505.0000 - _runtime: 3412.0000
Epoch 20/20


























































1320/1320 [==============================] - ETA: 0s - loss: 0.0011 - accuracy: 0.9997 - top-5-accuracy: 1.0000 - f1_m: 0.9997 - precision: 0.9997 - recall: 0.9997 - auc: 1.0000 - prc: 1.0000
Epoch 20: ReduceLROnPlateau reducing learning rate to 6.25000029685907e-05.
1320/1320 [==============================] - 170s 127ms/step - loss: 0.0011 - accuracy: 0.9997 - top-5-accuracy: 1.0000 - f1_m: 0.9997 - precision: 0.9997 - recall: 0.9997 - auc: 1.0000 - prc: 1.0000 - val_loss: 0.0027 - val_accuracy: 0.9990 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9990 - val_precision: 0.9990 - val_recall: 0.9990 - val_auc: 1.0000 - val_prc: 0.9999 - lr: 1.2500e-04 - _timestamp: 1659629675.0000 - _runtime: 3582.0000