[34m[1mwandb[39m[22m: [33mWARNING[39m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
08/04/2022 13:29:41 - INFO - __main__ -
08/04/2022 13:29:41 - INFO - __main__ -     =========== TRAINING MODEL pret_DenseNet201 ===========
08/04/2022 13:29:41 - INFO - __main__ -     Loss = <keras.losses.CategoricalCrossentropy object at 0x7f81bb5f7b50>
08/04/2022 13:29:41 - INFO - __main__ -     Optimizer = <keras.optimizers.optimizer_v2.adam.Adam object at 0x7f8088d0c430>
08/04/2022 13:29:41 - INFO - __main__ -     learning rate = 0.001
08/04/2022 13:29:41 - INFO - __main__ -
model --> <keras.engine.functional.Functional object at 0x7f8088e338e0>
Epoch 1/20
2022-08-04 13:29:59.161510: I tensorflow/stream_executor/cuda/cuda_dnn.cc:384] Loaded cuDNN version 8400
WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0468s vs `on_train_batch_end` time: 0.0663s). Check your callbacks.
08/04/2022 13:30:02 - WARNING - tensorflow -   Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0468s vs `on_train_batch_end` time: 0.0663s). Check your callbacks.




































1320/1320 [==============================] - 171s 117ms/step - loss: 0.8663 - accuracy: 0.7828 - top-5-accuracy: 0.9490 - f1_m: 0.7830 - precision: 0.8501 - recall: 0.7420 - auc: 0.9777 - prc: 0.8593 - val_loss: 0.3424 - val_accuracy: 0.8944 - val_top-5-accuracy: 0.9932 - val_f1_m: 0.8957 - val_precision: 0.9155 - val_recall: 0.8774 - val_auc: 0.9941 - val_prc: 0.9550 - lr: 0.0010 - _timestamp: 1659619954.0000 - _runtime: 176.0000
Epoch 2/20






































1320/1320 [==============================] - 157s 117ms/step - loss: 0.3586 - accuracy: 0.8988 - top-5-accuracy: 0.9927 - f1_m: 0.8999 - precision: 0.9160 - recall: 0.8848 - auc: 0.9932 - prc: 0.9547 - val_loss: 0.3032 - val_accuracy: 0.9071 - val_top-5-accuracy: 0.9956 - val_f1_m: 0.9086 - val_precision: 0.9191 - val_recall: 0.8987 - val_auc: 0.9941 - val_prc: 0.9621 - lr: 0.0010 - _timestamp: 1659620111.0000 - _runtime: 333.0000
Epoch 3/20






































1320/1320 [==============================] - 158s 118ms/step - loss: 0.2837 - accuracy: 0.9192 - top-5-accuracy: 0.9955 - f1_m: 0.9203 - precision: 0.9302 - recall: 0.9109 - auc: 0.9945 - prc: 0.9679 - val_loss: 0.2629 - val_accuracy: 0.9221 - val_top-5-accuracy: 0.9965 - val_f1_m: 0.9235 - val_precision: 0.9314 - val_recall: 0.9159 - val_auc: 0.9944 - val_prc: 0.9689 - lr: 0.0010 - _timestamp: 1659620268.0000 - _runtime: 490.0000
Epoch 4/20






































1320/1320 [==============================] - 169s 126ms/step - loss: 0.2434 - accuracy: 0.9306 - top-5-accuracy: 0.9972 - f1_m: 0.9312 - precision: 0.9383 - recall: 0.9244 - auc: 0.9953 - prc: 0.9742 - val_loss: 0.1994 - val_accuracy: 0.9380 - val_top-5-accuracy: 0.9982 - val_f1_m: 0.9386 - val_precision: 0.9440 - val_recall: 0.9334 - val_auc: 0.9964 - val_prc: 0.9795 - lr: 0.0010 - _timestamp: 1659620438.0000 - _runtime: 660.0000
Epoch 5/20






































1320/1320 [==============================] - 152s 114ms/step - loss: 0.2162 - accuracy: 0.9379 - top-5-accuracy: 0.9980 - f1_m: 0.9389 - precision: 0.9445 - recall: 0.9335 - auc: 0.9956 - prc: 0.9777 - val_loss: 0.1715 - val_accuracy: 0.9509 - val_top-5-accuracy: 0.9980 - val_f1_m: 0.9516 - val_precision: 0.9560 - val_recall: 0.9474 - val_auc: 0.9960 - val_prc: 0.9830 - lr: 0.0010 - _timestamp: 1659620590.0000 - _runtime: 812.0000
Epoch 6/20






































1320/1320 [==============================] - 152s 114ms/step - loss: 0.1953 - accuracy: 0.9429 - top-5-accuracy: 0.9983 - f1_m: 0.9436 - precision: 0.9481 - recall: 0.9392 - auc: 0.9958 - prc: 0.9796 - val_loss: 0.1513 - val_accuracy: 0.9525 - val_top-5-accuracy: 0.9989 - val_f1_m: 0.9531 - val_precision: 0.9569 - val_recall: 0.9495 - val_auc: 0.9972 - val_prc: 0.9858 - lr: 0.0010 - _timestamp: 1659620743.0000 - _runtime: 965.0000
Epoch 7/20





































1320/1320 [==============================] - 151s 113ms/step - loss: 0.1735 - accuracy: 0.9502 - top-5-accuracy: 0.9987 - f1_m: 0.9508 - precision: 0.9546 - recall: 0.9471 - auc: 0.9963 - prc: 0.9827 - val_loss: 0.1637 - val_accuracy: 0.9537 - val_top-5-accuracy: 0.9990 - val_f1_m: 0.9541 - val_precision: 0.9572 - val_recall: 0.9511 - val_auc: 0.9960 - val_prc: 0.9821 - lr: 0.0010 - _timestamp: 1659620895.0000 - _runtime: 1117.0000
Epoch 8/20




































1320/1320 [==============================] - 145s 108ms/step - loss: 0.1694 - accuracy: 0.9507 - top-5-accuracy: 0.9991 - f1_m: 0.9512 - precision: 0.9540 - recall: 0.9485 - auc: 0.9961 - prc: 0.9828 - val_loss: 0.1237 - val_accuracy: 0.9631 - val_top-5-accuracy: 0.9996 - val_f1_m: 0.9637 - val_precision: 0.9660 - val_recall: 0.9615 - val_auc: 0.9974 - val_prc: 0.9883 - lr: 0.0010 - _timestamp: 1659621039.0000 - _runtime: 1261.0000
Epoch 9/20



































1320/1320 [==============================] - 146s 109ms/step - loss: 0.1546 - accuracy: 0.9549 - top-5-accuracy: 0.9991 - f1_m: 0.9553 - precision: 0.9578 - recall: 0.9529 - auc: 0.9966 - prc: 0.9846 - val_loss: 0.0719 - val_accuracy: 0.9758 - val_top-5-accuracy: 0.9998 - val_f1_m: 0.9758 - val_precision: 0.9776 - val_recall: 0.9741 - val_auc: 0.9991 - val_prc: 0.9956 - lr: 0.0010 - _timestamp: 1659621241.0000 - _runtime: 1463.0000
Epoch 10/20




































1320/1320 [==============================] - 149s 112ms/step - loss: 0.1357 - accuracy: 0.9605 - top-5-accuracy: 0.9994 - f1_m: 0.9609 - precision: 0.9633 - recall: 0.9585 - auc: 0.9970 - prc: 0.9864 - val_loss: 0.0964 - val_accuracy: 0.9695 - val_top-5-accuracy: 0.9997 - val_f1_m: 0.9697 - val_precision: 0.9714 - val_recall: 0.9682 - val_auc: 0.9982 - val_prc: 0.9921 - lr: 0.0010 - _timestamp: 1659621392.0000 - _runtime: 1614.0000
Epoch 11/20





































1320/1320 [==============================] - 150s 112ms/step - loss: 0.1220 - accuracy: 0.9637 - top-5-accuracy: 0.9994 - f1_m: 0.9639 - precision: 0.9658 - recall: 0.9620 - auc: 0.9976 - prc: 0.9892 - val_loss: 0.1423 - val_accuracy: 0.9593 - val_top-5-accuracy: 0.9993 - val_f1_m: 0.9597 - val_precision: 0.9616 - val_recall: 0.9578 - val_auc: 0.9966 - val_prc: 0.9858 - lr: 0.0010 - _timestamp: 1659621542.0000 - _runtime: 1764.0000
Epoch 12/20





































1320/1320 [==============================] - ETA: 0s - loss: 0.1223 - accuracy: 0.9648 - top-5-accuracy: 0.9996 - f1_m: 0.9652 - precision: 0.9668 - recall: 0.9636 - auc: 0.9974 - prc: 0.9888
Epoch 12: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
1320/1320 [==============================] - 149s 112ms/step - loss: 0.1223 - accuracy: 0.9648 - top-5-accuracy: 0.9996 - f1_m: 0.9652 - precision: 0.9668 - recall: 0.9636 - auc: 0.9974 - prc: 0.9888 - val_loss: 0.1119 - val_accuracy: 0.9662 - val_top-5-accuracy: 0.9997 - val_f1_m: 0.9664 - val_precision: 0.9680 - val_recall: 0.9648 - val_auc: 0.9977 - val_prc: 0.9895 - lr: 0.0010 - _timestamp: 1659621691.0000 - _runtime: 1913.0000
Epoch 13/20




































1320/1320 [==============================] - 167s 125ms/step - loss: 0.0432 - accuracy: 0.9847 - top-5-accuracy: 0.9999 - f1_m: 0.9848 - precision: 0.9858 - recall: 0.9838 - auc: 0.9995 - prc: 0.9977 - val_loss: 0.0420 - val_accuracy: 0.9849 - val_top-5-accuracy: 0.9999 - val_f1_m: 0.9849 - val_precision: 0.9862 - val_recall: 0.9837 - val_auc: 0.9997 - val_prc: 0.9982 - lr: 5.0000e-04 - _timestamp: 1659621857.0000 - _runtime: 2079.0000
Epoch 14/20




































1320/1320 [==============================] - 150s 112ms/step - loss: 0.0363 - accuracy: 0.9867 - top-5-accuracy: 0.9999 - f1_m: 0.9868 - precision: 0.9876 - recall: 0.9860 - auc: 0.9996 - prc: 0.9982 - val_loss: 0.0301 - val_accuracy: 0.9898 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9900 - val_precision: 0.9907 - val_recall: 0.9893 - val_auc: 0.9998 - val_prc: 0.9990 - lr: 5.0000e-04 - _timestamp: 1659622007.0000 - _runtime: 2229.0000
Epoch 15/20





































1320/1320 [==============================] - 152s 114ms/step - loss: 0.0394 - accuracy: 0.9864 - top-5-accuracy: 0.9998 - f1_m: 0.9865 - precision: 0.9876 - recall: 0.9855 - auc: 0.9996 - prc: 0.9982 - val_loss: 0.0447 - val_accuracy: 0.9853 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9853 - val_precision: 0.9862 - val_recall: 0.9843 - val_auc: 0.9994 - val_prc: 0.9975 - lr: 5.0000e-04 - _timestamp: 1659622161.0000 - _runtime: 2383.0000
Epoch 16/20




































1320/1320 [==============================] - 151s 113ms/step - loss: 0.0354 - accuracy: 0.9873 - top-5-accuracy: 1.0000 - f1_m: 0.9873 - precision: 0.9880 - recall: 0.9866 - auc: 0.9997 - prc: 0.9986 - val_loss: 0.0324 - val_accuracy: 0.9888 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9888 - val_precision: 0.9896 - val_recall: 0.9880 - val_auc: 0.9998 - val_prc: 0.9990 - lr: 5.0000e-04 - _timestamp: 1659622312.0000 - _runtime: 2534.0000
Epoch 17/20






































1320/1320 [==============================] - ETA: 0s - loss: 0.0344 - accuracy: 0.9877 - top-5-accuracy: 1.0000 - f1_m: 0.9877 - precision: 0.9886 - recall: 0.9869 - auc: 0.9997 - prc: 0.9984
Epoch 17: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.
1320/1320 [==============================] - 153s 114ms/step - loss: 0.0344 - accuracy: 0.9877 - top-5-accuracy: 1.0000 - f1_m: 0.9877 - precision: 0.9886 - recall: 0.9869 - auc: 0.9997 - prc: 0.9984 - val_loss: 0.0429 - val_accuracy: 0.9874 - val_top-5-accuracy: 0.9999 - val_f1_m: 0.9874 - val_precision: 0.9882 - val_recall: 0.9865 - val_auc: 0.9993 - val_prc: 0.9973 - lr: 5.0000e-04 - _timestamp: 1659622464.0000 - _runtime: 2686.0000
Epoch 18/20






































1320/1320 [==============================] - 150s 112ms/step - loss: 0.0134 - accuracy: 0.9958 - top-5-accuracy: 1.0000 - f1_m: 0.9958 - precision: 0.9962 - recall: 0.9955 - auc: 0.9999 - prc: 0.9997 - val_loss: 0.0081 - val_accuracy: 0.9984 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9985 - val_precision: 0.9987 - val_recall: 0.9983 - val_auc: 1.0000 - val_prc: 0.9999 - lr: 2.5000e-04 - _timestamp: 1659622613.0000 - _runtime: 2835.0000
Epoch 19/20





































1320/1320 [==============================] - 152s 114ms/step - loss: 0.0108 - accuracy: 0.9968 - top-5-accuracy: 1.0000 - f1_m: 0.9968 - precision: 0.9971 - recall: 0.9964 - auc: 1.0000 - prc: 0.9999 - val_loss: 0.0164 - val_accuracy: 0.9944 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9944 - val_precision: 0.9946 - val_recall: 0.9942 - val_auc: 1.0000 - val_prc: 0.9998 - lr: 2.5000e-04 - _timestamp: 1659622819.0000 - _runtime: 3041.0000
Epoch 20/20







































1320/1320 [==============================] - 155s 116ms/step - loss: 0.0125 - accuracy: 0.9959 - top-5-accuracy: 1.0000 - f1_m: 0.9960 - precision: 0.9963 - recall: 0.9957 - auc: 1.0000 - prc: 0.9998 - val_loss: 0.0114 - val_accuracy: 0.9970 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9971 - val_precision: 0.9975 - val_recall: 0.9968 - val_auc: 1.0000 - val_prc: 0.9999 - lr: 2.5000e-04 - _timestamp: 1659622974.0000 - _runtime: 3196.0000