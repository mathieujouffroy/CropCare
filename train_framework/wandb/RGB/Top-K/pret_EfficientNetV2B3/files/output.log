
model --> <keras.engine.functional.Functional object at 0x7fe5b3b69a00>
[34m[1mwandb[39m[22m: [33mWARNING[39m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
08/04/2022 10:03:47 - INFO - __main__ -
08/04/2022 10:03:47 - INFO - __main__ -     =========== TRAINING MODEL pret_EfficientNetV2B3 ===========
08/04/2022 10:03:47 - INFO - __main__ -     Loss = <keras.losses.CategoricalCrossentropy object at 0x7fe6af0a3b50>
08/04/2022 10:03:47 - INFO - __main__ -     Optimizer = <keras.optimizers.optimizer_v2.adam.Adam object at 0x7fe594630250>
08/04/2022 10:03:47 - INFO - __main__ -     learning rate = 0.001
08/04/2022 10:03:47 - INFO - __main__ -
Epoch 1/20
2022-08-04 10:04:02.748016: I tensorflow/stream_executor/cuda/cuda_dnn.cc:384] Loaded cuDNN version 8400
  37/1320 [..............................] - ETA: 52s - loss: 3.0952 - accuracy: 0.2711 - top-5-accuracy: 0.5828 - f1_m: 0.0016 - precision: 1.0000 - recall: 8.4459e-04 - auc: 0.8063 - prc: 0.2531
WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0366s vs `on_train_batch_end` time: 0.0532s). Check your callbacks.


























1320/1320 [==============================] - 120s 81ms/step - loss: 0.6416 - accuracy: 0.8658 - top-5-accuracy: 0.9734 - f1_m: 0.7930 - precision: 0.9663 - recall: 0.7179 - auc: 0.9957 - prc: 0.9307 - val_loss: 0.2495 - val_accuracy: 0.9389 - val_top-5-accuracy: 0.9966 - val_f1_m: 0.9309 - val_precision: 0.9701 - val_recall: 0.8959 - val_auc: 0.9993 - val_prc: 0.9843 - lr: 0.0010 - _timestamp: 1659607549.0000 - _runtime: 124.0000
Epoch 2/20


























1320/1320 [==============================] - 104s 77ms/step - loss: 0.2146 - accuracy: 0.9485 - top-5-accuracy: 0.9978 - f1_m: 0.9436 - precision: 0.9721 - recall: 0.9176 - auc: 0.9995 - prc: 0.9884 - val_loss: 0.1587 - val_accuracy: 0.9602 - val_top-5-accuracy: 0.9987 - val_f1_m: 0.9575 - val_precision: 0.9773 - val_recall: 0.9390 - val_auc: 0.9996 - val_prc: 0.9928 - lr: 0.0010 - _timestamp: 1659607653.0000 - _runtime: 228.0000
Epoch 3/20

























1320/1320 [==============================] - 104s 77ms/step - loss: 0.1481 - accuracy: 0.9643 - top-5-accuracy: 0.9989 - f1_m: 0.9616 - precision: 0.9781 - recall: 0.9461 - auc: 0.9997 - prc: 0.9938 - val_loss: 0.1160 - val_accuracy: 0.9705 - val_top-5-accuracy: 0.9992 - val_f1_m: 0.9690 - val_precision: 0.9818 - val_recall: 0.9570 - val_auc: 0.9998 - val_prc: 0.9961 - lr: 0.0010 - _timestamp: 1659607758.0000 - _runtime: 333.0000
Epoch 4/20


























1320/1320 [==============================] - 103s 76ms/step - loss: 0.1146 - accuracy: 0.9721 - top-5-accuracy: 0.9991 - f1_m: 0.9706 - precision: 0.9821 - recall: 0.9597 - auc: 0.9998 - prc: 0.9960 - val_loss: 0.0901 - val_accuracy: 0.9784 - val_top-5-accuracy: 0.9996 - val_f1_m: 0.9772 - val_precision: 0.9861 - val_recall: 0.9688 - val_auc: 0.9998 - val_prc: 0.9976 - lr: 0.0010 - _timestamp: 1659607860.0000 - _runtime: 435.0000
Epoch 5/20
























1320/1320 [==============================] - 100s 74ms/step - loss: 0.0931 - accuracy: 0.9766 - top-5-accuracy: 0.9995 - f1_m: 0.9760 - precision: 0.9844 - recall: 0.9681 - auc: 0.9998 - prc: 0.9973 - val_loss: 0.0702 - val_accuracy: 0.9844 - val_top-5-accuracy: 0.9996 - val_f1_m: 0.9830 - val_precision: 0.9897 - val_recall: 0.9766 - val_auc: 0.9999 - val_prc: 0.9986 - lr: 0.0010 - _timestamp: 1659607999.0000 - _runtime: 574.0000
Epoch 6/20



























1320/1320 [==============================] - 107s 79ms/step - loss: 0.0771 - accuracy: 0.9814 - top-5-accuracy: 0.9997 - f1_m: 0.9807 - precision: 0.9875 - recall: 0.9742 - auc: 0.9999 - prc: 0.9981 - val_loss: 0.0594 - val_accuracy: 0.9863 - val_top-5-accuracy: 0.9998 - val_f1_m: 0.9856 - val_precision: 0.9908 - val_recall: 0.9806 - val_auc: 0.9999 - val_prc: 0.9988 - lr: 0.0010 - _timestamp: 1659608106.0000 - _runtime: 681.0000
Epoch 7/20


























1320/1320 [==============================] - 104s 78ms/step - loss: 0.0653 - accuracy: 0.9850 - top-5-accuracy: 0.9998 - f1_m: 0.9841 - precision: 0.9894 - recall: 0.9790 - auc: 0.9999 - prc: 0.9987 - val_loss: 0.0623 - val_accuracy: 0.9835 - val_top-5-accuracy: 0.9998 - val_f1_m: 0.9834 - val_precision: 0.9887 - val_recall: 0.9783 - val_auc: 0.9999 - val_prc: 0.9987 - lr: 0.0010 - _timestamp: 1659608211.0000 - _runtime: 786.0000
Epoch 8/20



























1320/1320 [==============================] - 105s 78ms/step - loss: 0.0570 - accuracy: 0.9866 - top-5-accuracy: 0.9998 - f1_m: 0.9859 - precision: 0.9904 - recall: 0.9817 - auc: 1.0000 - prc: 0.9990 - val_loss: 0.0478 - val_accuracy: 0.9892 - val_top-5-accuracy: 0.9998 - val_f1_m: 0.9885 - val_precision: 0.9926 - val_recall: 0.9845 - val_auc: 1.0000 - val_prc: 0.9993 - lr: 0.0010 - _timestamp: 1659608315.0000 - _runtime: 890.0000
Epoch 9/20




























1320/1320 [==============================] - 107s 79ms/step - loss: 0.0503 - accuracy: 0.9881 - top-5-accuracy: 0.9999 - f1_m: 0.9876 - precision: 0.9913 - recall: 0.9840 - auc: 1.0000 - prc: 0.9993 - val_loss: 0.0432 - val_accuracy: 0.9893 - val_top-5-accuracy: 0.9999 - val_f1_m: 0.9888 - val_precision: 0.9919 - val_recall: 0.9857 - val_auc: 1.0000 - val_prc: 0.9994 - lr: 0.0010 - _timestamp: 1659608422.0000 - _runtime: 997.0000
Epoch 10/20

























1320/1320 [==============================] - 103s 76ms/step - loss: 0.0445 - accuracy: 0.9896 - top-5-accuracy: 0.9999 - f1_m: 0.9892 - precision: 0.9924 - recall: 0.9861 - auc: 1.0000 - prc: 0.9995 - val_loss: 0.0340 - val_accuracy: 0.9926 - val_top-5-accuracy: 0.9999 - val_f1_m: 0.9927 - val_precision: 0.9950 - val_recall: 0.9904 - val_auc: 1.0000 - val_prc: 0.9997 - lr: 0.0010 - _timestamp: 1659608560.0000 - _runtime: 1135.0000
Epoch 11/20


























1320/1320 [==============================] - 142s 106ms/step - loss: 0.0392 - accuracy: 0.9914 - top-5-accuracy: 0.9999 - f1_m: 0.9910 - precision: 0.9934 - recall: 0.9886 - auc: 1.0000 - prc: 0.9996 - val_loss: 0.0308 - val_accuracy: 0.9944 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9940 - val_precision: 0.9963 - val_recall: 0.9919 - val_auc: 1.0000 - val_prc: 0.9998 - lr: 0.0010 - _timestamp: 1659608702.0000 - _runtime: 1277.0000
Epoch 12/20



























1320/1320 [==============================] - 142s 106ms/step - loss: 0.0359 - accuracy: 0.9918 - top-5-accuracy: 0.9999 - f1_m: 0.9916 - precision: 0.9940 - recall: 0.9893 - auc: 1.0000 - prc: 0.9997 - val_loss: 0.0285 - val_accuracy: 0.9946 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9944 - val_precision: 0.9962 - val_recall: 0.9926 - val_auc: 1.0000 - val_prc: 0.9998 - lr: 0.0010 - _timestamp: 1659608844.0000 - _runtime: 1419.0000
Epoch 13/20


























1320/1320 [==============================] - 105s 78ms/step - loss: 0.0322 - accuracy: 0.9929 - top-5-accuracy: 0.9999 - f1_m: 0.9930 - precision: 0.9951 - recall: 0.9910 - auc: 1.0000 - prc: 0.9997 - val_loss: 0.0291 - val_accuracy: 0.9939 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9938 - val_precision: 0.9957 - val_recall: 0.9919 - val_auc: 1.0000 - val_prc: 0.9998 - lr: 0.0010 - _timestamp: 1659609009.0000 - _runtime: 1584.0000
Epoch 14/20


























1320/1320 [==============================] - 107s 79ms/step - loss: 0.0289 - accuracy: 0.9944 - top-5-accuracy: 1.0000 - f1_m: 0.9942 - precision: 0.9959 - recall: 0.9926 - auc: 1.0000 - prc: 0.9998 - val_loss: 0.0252 - val_accuracy: 0.9949 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9947 - val_precision: 0.9961 - val_recall: 0.9933 - val_auc: 1.0000 - val_prc: 0.9999 - lr: 0.0010 - _timestamp: 1659609115.0000 - _runtime: 1690.0000
Epoch 15/20


























1320/1320 [==============================] - 105s 78ms/step - loss: 0.0266 - accuracy: 0.9950 - top-5-accuracy: 1.0000 - f1_m: 0.9947 - precision: 0.9962 - recall: 0.9932 - auc: 1.0000 - prc: 0.9998 - val_loss: 0.0217 - val_accuracy: 0.9962 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9961 - val_precision: 0.9974 - val_recall: 0.9949 - val_auc: 1.0000 - val_prc: 0.9999 - lr: 0.0010 - _timestamp: 1659609220.0000 - _runtime: 1795.0000
Epoch 16/20


























1320/1320 [==============================] - 104s 77ms/step - loss: 0.0242 - accuracy: 0.9951 - top-5-accuracy: 1.0000 - f1_m: 0.9949 - precision: 0.9965 - recall: 0.9934 - auc: 1.0000 - prc: 0.9999 - val_loss: 0.0198 - val_accuracy: 0.9968 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9965 - val_precision: 0.9976 - val_recall: 0.9956 - val_auc: 1.0000 - val_prc: 0.9999 - lr: 0.0010 - _timestamp: 1659609325.0000 - _runtime: 1900.0000
Epoch 17/20



























1320/1320 [==============================] - 142s 106ms/step - loss: 0.0224 - accuracy: 0.9955 - top-5-accuracy: 1.0000 - f1_m: 0.9955 - precision: 0.9968 - recall: 0.9941 - auc: 1.0000 - prc: 0.9999 - val_loss: 0.0200 - val_accuracy: 0.9962 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9960 - val_precision: 0.9972 - val_recall: 0.9949 - val_auc: 1.0000 - val_prc: 0.9999 - lr: 0.0010 - _timestamp: 1659609468.0000 - _runtime: 2043.0000
Epoch 18/20



























1320/1320 [==============================] - 106s 79ms/step - loss: 0.0203 - accuracy: 0.9962 - top-5-accuracy: 1.0000 - f1_m: 0.9962 - precision: 0.9973 - recall: 0.9951 - auc: 1.0000 - prc: 0.9999 - val_loss: 0.0151 - val_accuracy: 0.9981 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9979 - val_precision: 0.9986 - val_recall: 0.9972 - val_auc: 1.0000 - val_prc: 1.0000 - lr: 0.0010 - _timestamp: 1659609573.0000 - _runtime: 2148.0000
Epoch 19/20



























1320/1320 [==============================] - 107s 79ms/step - loss: 0.0190 - accuracy: 0.9965 - top-5-accuracy: 1.0000 - f1_m: 0.9964 - precision: 0.9973 - recall: 0.9956 - auc: 1.0000 - prc: 0.9999 - val_loss: 0.0158 - val_accuracy: 0.9975 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9974 - val_precision: 0.9983 - val_recall: 0.9966 - val_auc: 1.0000 - val_prc: 1.0000 - lr: 0.0010 - _timestamp: 1659609680.0000 - _runtime: 2255.0000
Epoch 20/20


























1320/1320 [==============================] - 104s 77ms/step - loss: 0.0174 - accuracy: 0.9972 - top-5-accuracy: 1.0000 - f1_m: 0.9970 - precision: 0.9978 - recall: 0.9962 - auc: 1.0000 - prc: 0.9999 - val_loss: 0.0139 - val_accuracy: 0.9979 - val_top-5-accuracy: 1.0000 - val_f1_m: 0.9979 - val_precision: 0.9985 - val_recall: 0.9972 - val_auc: 1.0000 - val_prc: 1.0000 - lr: 0.0010 - _timestamp: 1659609784.0000 - _runtime: 2359.0000