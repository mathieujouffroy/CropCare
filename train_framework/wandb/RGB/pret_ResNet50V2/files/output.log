
model --> <keras.engine.functional.Functional object at 0x7f11f5f221f0>
[34m[1mwandb[39m[22m: [33mWARNING[39m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
08/04/2022 09:20:29 - INFO - __main__ -
08/04/2022 09:20:29 - INFO - __main__ -     =========== TRAINING MODEL pret_ResNet50V2 ===========
08/04/2022 09:20:29 - INFO - __main__ -     Loss = <keras.losses.CategoricalCrossentropy object at 0x7f12e70ebb50>
08/04/2022 09:20:29 - INFO - __main__ -     Optimizer = <keras.optimizers.optimizer_v2.adam.Adam object at 0x7f130e088eb0>
08/04/2022 09:20:29 - INFO - __main__ -     learning rate = 0.001
08/04/2022 09:20:29 - INFO - __main__ -
Epoch 1/20
2022-08-04 09:20:38.630614: I tensorflow/stream_executor/cuda/cuda_dnn.cc:384] Loaded cuDNN version 8400
  37/1320 [..............................] - ETA: 41s - loss: 89.5485 - accuracy: 0.0448 - top-5-accuracy: 0.1546 - f1_m: 0.0450 - precision: 0.0451 - recall: 0.0448 - auc: 0.5117 - prc: 0.0287
WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0251s vs `on_train_batch_end` time: 0.0252s). Check your callbacks.





















1320/1320 [==============================] - 96s 67ms/step - loss: 21.7367 - accuracy: 0.3220 - top-5-accuracy: 0.6172 - f1_m: 0.3227 - precision: 0.3253 - recall: 0.3205 - auc: 0.6887 - prc: 0.1837 - val_loss: 17.2942 - val_accuracy: 0.3860 - val_top-5-accuracy: 0.6956 - val_f1_m: 0.3867 - val_precision: 0.3890 - val_recall: 0.3843 - val_auc: 0.7223 - val_prc: 0.2423 - lr: 0.0010 - _timestamp: 1659604927.0000 - _runtime: 100.0000
Epoch 2/20





















1320/1320 [==============================] - 85s 63ms/step - loss: 16.0486 - accuracy: 0.4599 - top-5-accuracy: 0.7584 - f1_m: 0.4605 - precision: 0.4624 - recall: 0.4587 - auc: 0.7570 - prc: 0.3104 - val_loss: 12.9896 - val_accuracy: 0.4842 - val_top-5-accuracy: 0.8118 - val_f1_m: 0.4845 - val_precision: 0.4859 - val_recall: 0.4830 - val_auc: 0.7701 - val_prc: 0.3317 - lr: 0.0010 - _timestamp: 1659605012.0000 - _runtime: 185.0000
Epoch 3/20






















1320/1320 [==============================] - 84s 62ms/step - loss: 15.0462 - accuracy: 0.5136 - top-5-accuracy: 0.8047 - f1_m: 0.5142 - precision: 0.5157 - recall: 0.5128 - auc: 0.7821 - prc: 0.3634 - val_loss: 18.8579 - val_accuracy: 0.4991 - val_top-5-accuracy: 0.7498 - val_f1_m: 0.4999 - val_precision: 0.5014 - val_recall: 0.4985 - val_auc: 0.7692 - val_prc: 0.3474 - lr: 0.0010 - _timestamp: 1659605097.0000 - _runtime: 270.0000
Epoch 4/20






















1320/1320 [==============================] - 85s 63ms/step - loss: 14.3864 - accuracy: 0.5528 - top-5-accuracy: 0.8360 - f1_m: 0.5531 - precision: 0.5543 - recall: 0.5520 - auc: 0.7994 - prc: 0.4032 - val_loss: 14.5679 - val_accuracy: 0.5703 - val_top-5-accuracy: 0.8281 - val_f1_m: 0.5706 - val_precision: 0.5716 - val_recall: 0.5697 - val_auc: 0.8065 - val_prc: 0.4238 - lr: 0.0010 - _timestamp: 1659605181.0000 - _runtime: 354.0000
Epoch 5/20






















1320/1320 [==============================] - 85s 63ms/step - loss: 14.5416 - accuracy: 0.5662 - top-5-accuracy: 0.8490 - f1_m: 0.5665 - precision: 0.5673 - recall: 0.5656 - auc: 0.8048 - prc: 0.4174 - val_loss: 12.0953 - val_accuracy: 0.5851 - val_top-5-accuracy: 0.8529 - val_f1_m: 0.5854 - val_precision: 0.5864 - val_recall: 0.5844 - val_auc: 0.8143 - val_prc: 0.4427 - lr: 0.0010 - _timestamp: 1659605266.0000 - _runtime: 439.0000
Epoch 6/20





















1320/1320 [==============================] - 84s 62ms/step - loss: 13.6841 - accuracy: 0.5891 - top-5-accuracy: 0.8632 - f1_m: 0.5896 - precision: 0.5904 - recall: 0.5888 - auc: 0.8139 - prc: 0.4398 - val_loss: 20.9063 - val_accuracy: 0.5226 - val_top-5-accuracy: 0.7681 - val_f1_m: 0.5229 - val_precision: 0.5235 - val_recall: 0.5223 - val_auc: 0.7729 - val_prc: 0.3508 - lr: 0.0010 - _timestamp: 1659605407.0000 - _runtime: 580.0000
Epoch 7/20






















1320/1320 [==============================] - 85s 63ms/step - loss: 13.8470 - accuracy: 0.6017 - top-5-accuracy: 0.8730 - f1_m: 0.6022 - precision: 0.6030 - recall: 0.6013 - auc: 0.8188 - prc: 0.4507 - val_loss: 11.3385 - val_accuracy: 0.6223 - val_top-5-accuracy: 0.8873 - val_f1_m: 0.6226 - val_precision: 0.6232 - val_recall: 0.6219 - val_auc: 0.8294 - val_prc: 0.4767 - lr: 0.0010 - _timestamp: 1659605492.0000 - _runtime: 665.0000
Epoch 8/20




















1320/1320 [==============================] - 82s 61ms/step - loss: 13.2815 - accuracy: 0.6204 - top-5-accuracy: 0.8804 - f1_m: 0.6208 - precision: 0.6215 - recall: 0.6201 - auc: 0.8282 - prc: 0.4745 - val_loss: 13.0980 - val_accuracy: 0.5991 - val_top-5-accuracy: 0.8800 - val_f1_m: 0.5994 - val_precision: 0.6001 - val_recall: 0.5988 - val_auc: 0.8158 - val_prc: 0.4432 - lr: 0.0010 - _timestamp: 1659605575.0000 - _runtime: 748.0000
Epoch 9/20





















1320/1320 [==============================] - 83s 61ms/step - loss: 13.6997 - accuracy: 0.6214 - top-5-accuracy: 0.8858 - f1_m: 0.6217 - precision: 0.6223 - recall: 0.6211 - auc: 0.8272 - prc: 0.4724 - val_loss: 11.4759 - val_accuracy: 0.6281 - val_top-5-accuracy: 0.9035 - val_f1_m: 0.6283 - val_precision: 0.6288 - val_recall: 0.6278 - val_auc: 0.8310 - val_prc: 0.4781 - lr: 0.0010 - _timestamp: 1659605658.0000 - _runtime: 831.0000
Epoch 10/20






















1320/1320 [==============================] - ETA: 0s - loss: 12.7367 - accuracy: 0.6461 - top-5-accuracy: 0.8973 - f1_m: 0.6464 - precision: 0.6469 - recall: 0.6459 - auc: 0.8396 - prc: 0.5032
Epoch 10: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
1320/1320 [==============================] - 85s 63ms/step - loss: 12.7367 - accuracy: 0.6461 - top-5-accuracy: 0.8973 - f1_m: 0.6464 - precision: 0.6469 - recall: 0.6459 - auc: 0.8396 - prc: 0.5032 - val_loss: 14.4462 - val_accuracy: 0.5823 - val_top-5-accuracy: 0.8826 - val_f1_m: 0.5826 - val_precision: 0.5832 - val_recall: 0.5820 - val_auc: 0.8048 - val_prc: 0.4186 - lr: 0.0010 - _timestamp: 1659605743.0000 - _runtime: 916.0000
Epoch 11/20





















1320/1320 [==============================] - 84s 62ms/step - loss: 6.5569 - accuracy: 0.7342 - top-5-accuracy: 0.9497 - f1_m: 0.7344 - precision: 0.7350 - recall: 0.7338 - auc: 0.8861 - prc: 0.6305 - val_loss: 7.5829 - val_accuracy: 0.6936 - val_top-5-accuracy: 0.9150 - val_f1_m: 0.6940 - val_precision: 0.6948 - val_recall: 0.6932 - val_auc: 0.8659 - val_prc: 0.5795 - lr: 5.0000e-04 - _timestamp: 1659605827.0000 - _runtime: 1000.0000
Epoch 12/20





















1320/1320 [==============================] - 83s 62ms/step - loss: 6.5381 - accuracy: 0.7302 - top-5-accuracy: 0.9460 - f1_m: 0.7306 - precision: 0.7313 - recall: 0.7299 - auc: 0.8846 - prc: 0.6271 - val_loss: 10.8199 - val_accuracy: 0.6179 - val_top-5-accuracy: 0.8822 - val_f1_m: 0.6182 - val_precision: 0.6190 - val_recall: 0.6175 - val_auc: 0.8269 - val_prc: 0.4724 - lr: 5.0000e-04 - _timestamp: 1659605911.0000 - _runtime: 1084.0000
Epoch 13/20






















1320/1320 [==============================] - 86s 64ms/step - loss: 6.6022 - accuracy: 0.7280 - top-5-accuracy: 0.9461 - f1_m: 0.7284 - precision: 0.7293 - recall: 0.7275 - auc: 0.8841 - prc: 0.6237 - val_loss: 6.0637 - val_accuracy: 0.7158 - val_top-5-accuracy: 0.9465 - val_f1_m: 0.7161 - val_precision: 0.7171 - val_recall: 0.7152 - val_auc: 0.8806 - val_prc: 0.6128 - lr: 5.0000e-04 - _timestamp: 1659605996.0000 - _runtime: 1169.0000
Epoch 14/20






















1320/1320 [==============================] - 85s 63ms/step - loss: 6.5086 - accuracy: 0.7292 - top-5-accuracy: 0.9444 - f1_m: 0.7295 - precision: 0.7302 - recall: 0.7289 - auc: 0.8849 - prc: 0.6267 - val_loss: 5.2021 - val_accuracy: 0.7626 - val_top-5-accuracy: 0.9577 - val_f1_m: 0.7629 - val_precision: 0.7636 - val_recall: 0.7622 - val_auc: 0.9026 - val_prc: 0.6796 - lr: 5.0000e-04 - _timestamp: 1659606082.0000 - _runtime: 1255.0000
Epoch 15/20





















1320/1320 [==============================] - 84s 62ms/step - loss: 6.0187 - accuracy: 0.7409 - top-5-accuracy: 0.9501 - f1_m: 0.7412 - precision: 0.7420 - recall: 0.7405 - auc: 0.8906 - prc: 0.6435 - val_loss: 4.8490 - val_accuracy: 0.7529 - val_top-5-accuracy: 0.9656 - val_f1_m: 0.7533 - val_precision: 0.7541 - val_recall: 0.7525 - val_auc: 0.8985 - val_prc: 0.6633 - lr: 5.0000e-04 - _timestamp: 1659606165.0000 - _runtime: 1338.0000
Epoch 16/20





















1320/1320 [==============================] - 86s 63ms/step - loss: 6.1187 - accuracy: 0.7331 - top-5-accuracy: 0.9503 - f1_m: 0.7334 - precision: 0.7341 - recall: 0.7327 - auc: 0.8878 - prc: 0.6338 - val_loss: 5.1245 - val_accuracy: 0.7434 - val_top-5-accuracy: 0.9498 - val_f1_m: 0.7436 - val_precision: 0.7444 - val_recall: 0.7429 - val_auc: 0.8945 - val_prc: 0.6548 - lr: 5.0000e-04 - _timestamp: 1659606252.0000 - _runtime: 1425.0000
Epoch 17/20






















1320/1320 [==============================] - 84s 62ms/step - loss: 6.0125 - accuracy: 0.7412 - top-5-accuracy: 0.9499 - f1_m: 0.7416 - precision: 0.7423 - recall: 0.7409 - auc: 0.8911 - prc: 0.6460 - val_loss: 6.0805 - val_accuracy: 0.7176 - val_top-5-accuracy: 0.9421 - val_f1_m: 0.7181 - val_precision: 0.7190 - val_recall: 0.7172 - val_auc: 0.8815 - val_prc: 0.6192 - lr: 5.0000e-04 - _timestamp: 1659606336.0000 - _runtime: 1509.0000
Epoch 18/20





















1320/1320 [==============================] - ETA: 0s - loss: 5.8469 - accuracy: 0.7419 - top-5-accuracy: 0.9511 - f1_m: 0.7420 - precision: 0.7427 - recall: 0.7413 - auc: 0.8919 - prc: 0.6462
Epoch 18: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.
1320/1320 [==============================] - 82s 61ms/step - loss: 5.8469 - accuracy: 0.7419 - top-5-accuracy: 0.9511 - f1_m: 0.7420 - precision: 0.7427 - recall: 0.7413 - auc: 0.8919 - prc: 0.6462 - val_loss: 8.2546 - val_accuracy: 0.6809 - val_top-5-accuracy: 0.9222 - val_f1_m: 0.6811 - val_precision: 0.6820 - val_recall: 0.6802 - val_auc: 0.8634 - val_prc: 0.5636 - lr: 5.0000e-04 - _timestamp: 1659606418.0000 - _runtime: 1591.0000
Epoch 19/20





















1320/1320 [==============================] - 84s 62ms/step - loss: 3.2923 - accuracy: 0.8088 - top-5-accuracy: 0.9754 - f1_m: 0.8091 - precision: 0.8099 - recall: 0.8084 - auc: 0.9251 - prc: 0.7492 - val_loss: 3.5523 - val_accuracy: 0.7979 - val_top-5-accuracy: 0.9691 - val_f1_m: 0.7981 - val_precision: 0.7988 - val_recall: 0.7975 - val_auc: 0.9183 - val_prc: 0.7297 - lr: 2.5000e-04 - _timestamp: 1659606501.0000 - _runtime: 1674.0000
Epoch 20/20























1320/1320 [==============================] - 86s 63ms/step - loss: 3.3908 - accuracy: 0.8019 - top-5-accuracy: 0.9742 - f1_m: 0.8022 - precision: 0.8030 - recall: 0.8013 - auc: 0.9230 - prc: 0.7414 - val_loss: 2.8225 - val_accuracy: 0.8104 - val_top-5-accuracy: 0.9791 - val_f1_m: 0.8106 - val_precision: 0.8113 - val_recall: 0.8099 - val_auc: 0.9280 - val_prc: 0.7559 - lr: 2.5000e-04 - _timestamp: 1659606587.0000 - _runtime: 1760.0000